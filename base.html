<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CYBER DASH | Professional Edition</title>
    <style>
        /* CSS: STYLING & TOUCH PROTECTION */
        :root {
            --cyan: #00f3ff;
            --pink: #ff00ff;
            --dark: #050510;
        }

        * {
            /* Critical: Blocks the "Copy/Share/Cut" menu and text selection */
            -webkit-touch-callout: none !important;
            -webkit-user-select: none !important;
            user-select: none !important;
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
        }

        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background: var(--dark);
            overflow: hidden;
            font-family: 'Segoe UI', Arial, sans-serif;
            touch-action: none; /* Disables browser zoom/scroll for zero-lag input */
        }

        canvas { display: block; }

        /* HUD - Top Center */
        .hud {
            position: absolute; top: 20px; width: 100%;
            display: flex; justify-content: center; gap: 10px;
            z-index: 10; pointer-events: none;
        }

        .stat {
            background: rgba(0, 0, 0, 0.85);
            border: 1px solid var(--cyan);
            padding: 8px 15px; border-radius: 5px;
            color: var(--cyan); font-weight: bold; font-size: 0.85rem;
            min-width: 90px; text-align: center;
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.2);
        }

        /* Centered Menu & Game Over */
        .screen {
            position: absolute; inset: 0;
            display: flex; justify-content: center; align-items: center;
            background: rgba(5, 5, 16, 0.95);
            z-index: 20; text-align: center;
        }

        .content-box {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid var(--cyan);
            padding: 40px; border-radius: 20px;
            box-shadow: 0 0 40px rgba(0, 243, 255, 0.3);
            width: 85%; max-width: 380px;
        }

        .neon-title { color: var(--cyan); text-shadow: 0 0 15px var(--cyan); margin: 0 0 10px 0; }
        .fail-text { color: var(--pink); text-shadow: 0 0 15px var(--pink); }

        .play-btn {
            background: transparent; color: white;
            border: 1px solid var(--cyan);
            padding: 15px 30px; margin: 10px;
            cursor: pointer; font-size: 1.1rem;
            font-weight: bold; width: 100%;
            transition: 0.2s;
        }

        .play-btn:active { background: var(--cyan); color: black; }

        /* Mobile Nav Buttons */
        .mobile-nav {
            position: absolute; bottom: 0; width: 100%;
            height: 180px; display: flex; z-index: 30;
        }

        .nav-zone {
            flex: 1; display: flex; align-items: center; justify-content: center;
            font-size: 4rem; color: var(--cyan);
            background: rgba(0, 243, 255, 0.02);
            border-top: 1px solid rgba(0, 243, 255, 0.1);
        }

        .nav-zone:active { background: rgba(0, 243, 255, 0.15); }

        .hidden { display: none !important; }

        .crt-overlay {
            position: fixed; inset: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px; pointer-events: none; z-index: 100;
        }
    </style>
</head>
<body>
    <div class="crt-overlay"></div>
    
    <div class="hud">
        <div class="stat">SCORE <span id="score">0</span></div>
        <div class="stat">BEST <span id="highScore">0</span></div>
        <div class="stat">HULL <span id="health">5</span></div>
    </div>

    <div id="menu" class="screen">
        <div class="content-box">
            <h1 class="neon-title">CYBER DASH</h1>
            <p style="color: #aaa; margin-bottom: 25px;">AUTO-FIRE PROTOCOL ACTIVE</p>
            <button class="play-btn" onclick="startGame('single')">START MISSION</button>
            <p style="font-size: 0.8rem; opacity: 0.6; margin-top: 20px;">Use Arrows or Tap Sides to Move</p>
        </div>
    </div>

    <div id="gameOverScreen" class="screen hidden">
        <div class="content-box">
            <h2 class="fail-text">SYSTEM CRASH</h2>
            <p>FINAL SCORE: <span id="finalScore">0</span></p>
            <button class="play-btn" onclick="restartGame()">REBOOT</button>
        </div>
    </div>

    <div class="mobile-nav">
        <div class="nav-zone" ontouchstart="handleMove('Left', true, event)" ontouchend="handleMove('Left', false, event)">◀</div>
        <div class="nav-zone" ontouchstart="handleMove('Right', true, event)" ontouchend="handleMove('Right', false, event)">▶</div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        /* JS: GAME LOGIC & HIGH-SPEED INPUT */
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // Block context menu (Stops Copy/Paste/Share menu)
        window.oncontextmenu = (e) => { e.preventDefault(); e.stopPropagation(); return false; };

        let gameState = "menu";
        let score = 0, health = 5;
        let highScore = localStorage.getItem("cyberHighScore") || 0;
        let players = [], bullets = [], enemies = [], stars = [];

        document.getElementById("highScore").textContent = highScore;

        // Populate Starfield
        for(let i=0; i<70; i++) stars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*2});

        class Player {
            constructor(x, color) {
                this.x = x;
                this.y = canvas.height - 250; 
                this.w = 42; this.h = 42;
                this.color = color;
                this.vx = 0; this.acc = 1.5; this.fric = 0.85;
                this.reload = 0;
            }

            update() {
                this.vx *= this.fric;
                this.x += this.vx;
                if (this.x < 0) this.x = 0;
                if (this.x + this.w > canvas.width) this.x = canvas.width - this.w;

                // Auto-Fire
                this.reload++;
                if (this.reload > 14) { this.shoot(); this.reload = 0; }
            }

            draw() {
                ctx.save();
                ctx.shadowBlur = 15; ctx.shadowColor = this.color;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.moveTo(this.x + this.w/2, this.y);
                ctx.lineTo(this.x, this.y + this.h);
                ctx.lineTo(this.x + this.w, this.y + this.h);
                ctx.fill();
                ctx.restore();
            }

            shoot() {
                bullets.push({x: this.x + this.w/2 - 2, y: this.y, w: 4, h: 14, v: 13, color: this.color});
            }
        }

        const keys = {};
        window.addEventListener("keydown", e => keys[e.code] = true);
        window.addEventListener("keyup", e => keys[e.code] = false);

        // Fast Move Handler
        function handleMove(dir, active, event) {
            if (event) {
                if (event.cancelable) event.preventDefault();
                event.stopPropagation();
            }
            if (dir === 'Left') keys['ArrowLeft'] = active;
            if (dir === 'Right') keys['ArrowRight'] = active;
        }

        function startGame(mode) {
            gameState = "playing"; score = 0; health = 5;
            bullets = []; enemies = []; players = [];
            players.push(new Player(canvas.width/2 - 21, '#00f3ff'));
            
            document.getElementById("menu").classList.add("hidden");
            document.getElementById("gameOverScreen").classList.add("hidden");
            update();
        }

        function spawnEnemy() {
            if (gameState !== "playing") return;
            enemies.push({ 
                x: Math.random()*(canvas.width-40), 
                y: -50, w: 40, h: 40, 
                v: 4 + (score * 0.05)
            });
        }
        setInterval(spawnEnemy, 1000);

        function update() {
            if (gameState !== "playing") return;
            ctx.fillStyle = "#050510";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Stars
            ctx.fillStyle = "white";
            stars.forEach(s => { s.y += 1.5; if (s.y > canvas.height) s.y = 0; ctx.fillRect(s.x, s.y, s.s, s.s); });

            // Players
            players.forEach(p => {
                if (keys['ArrowLeft'] || keys['KeyA']) p.vx -= p.acc;
                if (keys['ArrowRight'] || keys['KeyD']) p.vx += p.acc;
                p.update(); p.draw();
            });

            // Bullets
            bullets.forEach((b, bi) => {
                b.y -= b.v; ctx.fillStyle = b.color; ctx.fillRect(b.x, b.y, b.w, b.h);
                if (b.y < 0) bullets.splice(bi, 1);
            });

            // Enemies logic
            enemies.forEach((en, ei) => {
                en.y += en.v;
                ctx.strokeStyle = "red"; ctx.lineWidth = 2; ctx.strokeRect(en.x, en.y, en.w, en.h);

                // Collision Detection
                bullets.forEach((b, bi) => {
                    if (b.x < en.x+en.w && b.x+b.w > en.x && b.y < en.y+en.h && b.y+b.h > en.y) {
                        enemies.splice(ei, 1); bullets.splice(bi, 1);
                        score += 1; // Strict +1 point
                        if (score > highScore) {
                            highScore = score;
                            localStorage.setItem("cyberHighScore", highScore);
                            document.getElementById("highScore").textContent = highScore;
                        }
                    }
                });

                // Fail states
                if (en.y > canvas.height) {
                    enemies.splice(ei, 1); health--;
                    if (health <= 0) {
                        gameState = "over";
                        document.getElementById("gameOverScreen").classList.remove("hidden");
                        document.getElementById("finalScore").textContent = score;
                    }
                }
            });

            document.getElementById("score").textContent = score;
            document.getElementById("health").textContent = health;
            requestAnimationFrame(update);
        }

        function restartGame() { location.reload(); }
    </script>
</body>
</html>